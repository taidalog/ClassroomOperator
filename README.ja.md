# ClassroomOperator

Google Classroom を操作するための GAS のコード。

Version 2.0.0

[English README](README.md)

## 機能

- 自分が所属しているクラスを一覧表示
- クラスを一括作成
- クラスに生徒や教師を一括招待
- クラスを一括アーカイブ
- クラスを一括削除

## 初期設定

1. [Google Drive](https://drive.google.com/) を開く（サインインする）
1. 新しく空白の Google スプレッドシートを作成する（ファイル名は適当に付ける）
1. 画面上部のボタンを [拡張機能] > [Apps Script] とクリックし、スクリプトエディタを開く
1. スクリプトエディタに元々書いてあったコードを全て削除し、[main.gs](https://github.com/taidalog/ClassroomOperator/blob/main/main.gs)のコードを全て貼り付け、保存する
1. スクリプトエディタ左側の「サービス」の右にある [+] をクリックする
1. 「サービスを追加」画面で「Google Classroom API」を探してクリックし、右下の [追加] をクリックする
1. スプレッドシートに戻り、画面を更新する

以上の操作を行うことで、スプレッドシートの画面上部にあるメニューバーに [クラスルーム一括処理] というボタンが登場するはずです。ここから上記の各種機能を使用できます。

また、それぞれ [一覧・削除]、[作成]、[招待] という名前のシートも出現したはずです。シート名は変更しないでください。シートの順番は変更して構いません。このシートを使ってクラスルームを操作します。元々存在していた空白のシートは削除して構いません。

初回のみ、プログラムの実行を許可する操作が必要です。以下の手順で操作してください。  
※途中の注意事項等をよくお読みください。  
※アカウントの種類によって手順が異なる可能性があります。許可する方向で進んでください。

1. 画面上部のボタンを [クラスルーム一括処理] > [クラスを一覧表示] > [実行] の順にクリックする（本当はどれでもいい）
1. 「認証が必要です このドキュメントに添付されたスクリプトを実行するには、あなたの許可が必要です。」というメッセージが出たら [OK] をクリックする
1. アカウント選択画面が出るはずなので、自分のアカウントをクリックする
1. 次の画面で、左下 [詳細] > [○○（安全ではないページ）に移動] > [許可] の順でクリックする

以上で実行許可の操作は終了です。これ以降、画面上部のボタンから各種機能を使用できます。

## 各種機能の使い方

### 自分が所属しているクラスを一覧表示

1. 画面上部のボタンを [クラスルーム一括処理] > [クラスを一覧表示] > [実行] の順にクリックする

[一覧・削除] シートに結果が出力されます。

項目の意味については[公式ドキュメント](https://developers.google.com/classroom/reference/rest/v1/courses#Course.FIELDS-table)を参照してください。

### クラスを一括作成

1. [作成] シートに項目を入力する
1. 画面上部のボタンを [クラスルーム一括処理] > [クラスを一括作成] > [実行] の順にクリックする

| 必須項目 | 内容                 |
| -------- | -------------------- |
| name     | 作成するクラスの名前 |

項目の意味については[公式ドキュメント](https://developers.google.com/classroom/reference/rest/v1/courses#Course.FIELDS-table)を参照してください。

### クラスに生徒や教師を一括招待

1. [招待] シートに項目を入力する
1. 画面上部のボタンを [クラスルーム一括処理] > [クラスを一括招待] > [実行] の順にクリックする

| 必須項目 | 内容                                                |
| -------- | --------------------------------------------------- |
| courseId | 招待先クラスの ID。「クラスを一覧表示」で取得できる |
| userId   | 招待する相手のメールアドレス                        |
| role     | STUDENT/TEACHER                                     |

項目の意味については[公式ドキュメント](https://developers.google.com/classroom/reference/rest/v1/invitations#Invitation.FIELDS-table)を参照してください。

### クラスを一括アーカイブ

1. [一覧・削除] シートで、アーカイブしたいクラスにチェックを入れる
1. 画面上部のボタンを [クラスルーム一括処理] > [クラスを一括削除] > [一括アーカイブ] の順にクリックする

招待されているものの、「承諾」も「辞退」もしていないクラス（`courseState` が `PROVISIONED` のもの）はアーカイブまたは削除できません。先に承諾か辞退をしてください。

また、意図しないクラスをアーカイブ又は削除することを避けるため、[一覧・削除] シート上の `name` や `id` が実際のものと一致しないクラスは処理から除外します。

### クラスを一括削除

1. [一覧・削除] シートで、削除したいクラスにチェックを入れる
1. 画面上部のボタンを [クラスルーム一括処理] > [クラスを一括削除] > [一括削除] の順にクリックする

招待されているものの、「承諾」も「辞退」もしていないクラス（`courseState` が `PROVISIONED` のもの）はアーカイブまたは削除できません。先に承諾か辞退をしてください。

また、意図しないクラスをアーカイブ又は削除することを避けるため、[一覧・削除] シート上の `name` や `id` が実際のものと一致しないクラスは処理から除外します。

## 免責事項

- 当スクリプトを使用したことによるいかなる不利益に対しても私は責任を負いません。自己責任でお願いします。
- 当スクリプトを使用する前に個人情報の利用方針やルールを勤務先で確認してください。

## 既知の問題

-

## リリースノート

[Releases on GitHub](https://github.com/taidalog/ClassroomOperator/releases)

## License

This application is licensed under MIT license.
